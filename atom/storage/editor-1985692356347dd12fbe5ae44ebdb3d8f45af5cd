{"mode":"editor","version":1,"windowDimensions":{"x":101,"y":22,"width":1024,"height":950},"syntax":{"deserializer":"Syntax","grammarOverridesByPath":{}},"project":{"path":"/Users/marian/Projects/miniprojects/typo-deploy","buffers":[{"text":"{\n  \"name\": \"typo-deploy\",\n  \"version\": \"0.1.0\",\n  \"description\": \"A deployment script for TYPO3-projects.\",\n  \"main\": \"app.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"author\": \"Marian Sievers\",\n  \"license\": \"MIT\",\n  \"dependencies\": {\n  \t\"commander\": \">=2.1.0\",\n  \t\"colors\": \">=0.6.2\",\n  \t\"simple-git\": \">=0.6.0\",\n  \t\"dateformat\": \">=1.0.0\",\n  \t\"chmodr\": \">=0.1.0\"\n  }\n}","markers":{"markers":{"1":{"id":1,"range":[[0,0],[0,0]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":15},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/marian/Projects/miniprojects/typo-deploy/package.json","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"e39389d66b0c8e8d104ca0c54fced694fe121afe","deserializer":"TextBuffer"},{"text":"var colors = require(\"colors\"),\n\tgit = require(\"simple-git\")(),\n\tcommander = require(\"commander\"),\n\tfs = require(\"fs\"),\n\tdateFormat = require('dateformat'),\n\tchmodr = require(\"chmodr\");\n\n\nvar app = {\n\trepoUrl: \"git@gitlab.com:rotespferd/spd-hoevelhof-typo3.git\",\n\tcheckoutFolderName: \"\",\n\tinit: function() {\n\t\tconsole.log(\"Welcome to the TYPO3-deployment.\");\n\n\t\tcommander\n\t\t\t.version(\"0.1.0\")\n\t\t\t.option(\"-p, --phase [type]\", \"Phase in the development-cycle\")\n\t\t\t.parse(process.argv);\n\n\t\tconsole.log(\"You want the phase \" + commander.phase);\n\n\t\tapp.createCheckoutDir();\n\t},\n\tcreateCheckoutDir: function() {\n\t\tvar currentDateTime = new Date();\n\t\tapp.checkoutFolderName = \"checkouts/checkout-\" + dateFormat(currentDateTime, \"yyyymmdd_hMMss\");\n\n\t\tfs.mkdirSync(app.checkoutFolderName);\n\t\tapp.checkoutRepo();\n\t},\n\tcheckoutRepo: function() {\n\t\tgit.clone(app.repoUrl, app.checkoutFolderName, function(err, data) {\n\t\t\tconsole.log(\"Checkout done\");\n\t\t\tapp.symlinkAndFolderCreation();\n\t\t})\n\t},\n\tsymlinkAndFolderCreation: function() {\n        // link typo sources\n\t\tfs.symlinkSync(\"typo3_src/t3lib\", app.checkoutFolderName + \"/t3lib\");\n\t\tfs.symlinkSync(\"typo3_src/typo3\", app.checkoutFolderName + \"/typo3\");\n\n        // link useruploads in\n        fs.symlink(\"../../../user_upload\", app.checkoutFolderName + \"/fileadmin/user_upload\");\n\t\t// fs.mkdirSync(app.checkoutFolderName + \"/fileadmin/user_upload\");\n\n        // link LocalConfig.php\n        fs.symlinkSync(\"../../../LocalConfig.php\", app.checkoutFolderName + \"/typo3conf/LocalConfig.php\");\n\n\t\t// set the correct rights\n\t\t// chmodr.sync(app.checkoutFolderName, \"775\");\n\t\t\n\t\tapp.symlinkToPhase();\n\t},\n\tsymlinkToPhase: function() {\n        // if symlink exists, remove it\n        if(fs.existsSync(commander.phase)) {\n            fs.unlinkSync(commander.phase);\n        }\n\n\t\tfs.symlinkSync(app.checkoutFolderName, commander.phase);\n\t}\n};\n\napp.init();","markers":{"markers":{"1":{"id":1,"range":[[9,11],[9,60]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":17,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/marian/Projects/miniprojects/typo-deploy/app.js","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"494c30262d65d05f15d636fb118868999e6252b6","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"items":[{"id":15,"softTabs":true,"scrollTop":0,"scrollLeft":0,"displayBuffer":{"id":16,"softWrap":false,"editorWidthInChars":100,"tokenizedBuffer":{"bufferPath":"/Users/marian/Projects/miniprojects/typo-deploy/package.json","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":17,"softTabs":false,"scrollTop":0,"scrollLeft":0,"displayBuffer":{"id":18,"softWrap":false,"editorWidthInChars":100,"tokenizedBuffer":{"bufferPath":"/Users/marian/Projects/miniprojects/typo-deploy/app.js","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"}],"activeItemUri":"/Users/marian/Projects/miniprojects/typo-deploy/app.js","focused":true,"active":true,"deserializer":"Pane"},"deserializer":"PaneContainer"},"fullScreen":false,"deserializer":"Workspace"},"packageStates":{"command-logger":{"eventLog":{}},"fuzzy-finder":{"/Users/marian/Projects/miniprojects/typo-deploy/package.json":1397152115626,"/Users/marian/Projects/miniprojects/typo-deploy/app.js":1397152117363},"keybinding-resolver":{"attached":false},"metrics":{"sessionLength":755404},"tree-view":{"directoryExpansionStates":{},"selectedPath":"/Users/marian/Projects/miniprojects/typo-deploy/app.js","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}}}